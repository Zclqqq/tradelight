(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{285:(e,t,r)=>{"use strict";r.d(t,{$:()=>d,r:()=>o});var s=r(5155),a=r(2115),l=r(4253),n=r(2085),i=r(9434);let o=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-none text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-foreground bg-transparent hover:bg-foreground hover:text-background",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 px-3",lg:"h-11 px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,t)=>{let{className:r,variant:a,size:n,asChild:d=!1,...c}=e,u=d?l.DX:"button";return(0,s.jsx)(u,{className:(0,i.cn)(o({variant:a,size:n,className:r})),ref:t,...c})});d.displayName="Button"},2751:(e,t,r)=>{Promise.resolve().then(r.bind(r,3727))},3727:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>E});var s=r(5155),a=r(2115),l=r(3013),n=r(9164),i=r(4548),o=r(5119),d=r(4641),c=r(7860),u=r(3520),m=r(2266),f=r(5972),x=r(7690),g=r(8718),p=r(965),h=r(3158),v=r(9434),N=r(285),y=r(5695),j=r(6874),b=r.n(j);function w(){let e=(0,y.useRouter)(),[t,r]=a.useState(new Date),[j,w]=a.useState(null),[S,L]=a.useState({});a.useEffect(()=>{let e=()=>{w(new Date);let e=localStorage.getItem("all-trades");if(e)try{let t=JSON.parse(e),r={};t.forEach(e=>{var t,s,a;if(!e.date)return;let n=new Date(e.date),i=(0,l.GP)(n,"yyyy-MM-dd");r[i]||(r[i]={pnl:0,tradeCount:0,isLogged:!1});let o=(null==(t=e.trades)?void 0:t.reduce((e,t)=>e+(t.pnl||0),0))||0,d=null==(s=e.trades)?void 0:s.some(e=>!!e.analysisImage);r[i].pnl+=o,r[i].tradeCount+=(null==(a=e.trades)?void 0:a.length)||0,r[i].isLogged=0!==o||d&&0===o}),L(r)}catch(e){console.error("Failed to parse trade logs from localStorage",e),L({})}else L({})};e();let t=()=>{e()};return window.addEventListener("storage",t),e(),()=>{window.removeEventListener("storage",t)}},[]);let T=(0,n.w)(t),C=(0,i.k)(T,{weekStartsOn:0}),D=(0,o.$)((0,d.p)(T),{weekStartsOn:0}),M=(0,c.k)({start:C,end:D}),k=[];for(let e=0;e<M.length;e+=7)k.push(M.slice(e,e+7));let P=k[k.length-1];P&&k.length>5&&P.every(e=>!(0,u.t)(e,t))&&k.pop();let R=k.flat(),E=e=>!!j&&(0,x.c)(e),O=t=>{let r=(0,l.GP)(t,"yyyy-MM-dd");e.push("/log-day?date=".concat(r))};return(0,s.jsxs)("div",{className:"border border-foreground",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-2",children:[(0,s.jsx)("h2",{className:"text-lg font-bold font-headline uppercase",children:(0,l.GP)(t,"MMMM yyyy")}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(N.$,{variant:"outline",asChild:!0,children:(0,s.jsx)(b(),{href:"/log-day",children:"Log Day"})}),(0,s.jsxs)(N.$,{variant:"outline",size:"icon",className:"h-10 w-10",onClick:()=>{let e=localStorage.getItem("all-trades");if(!e)return void alert("No trade data to export.");try{let t=JSON.parse(e),r=[];t.sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()).forEach(e=>{if(!e.trades||0===e.trades.length){let t=[(0,l.GP)(new Date(e.date),"yyyy-MM-dd"),"0","","","","","","","",'"'.concat((e.notes||"").replace(/"/g,'""'),'"'),...[,,,,,].fill("")];r.push(t);return}e.trades.forEach(t=>{let s=t.pnl||0;if(0!==s||t.instrument){var a,n,i,o,d;let c=[(0,l.GP)(new Date(e.date),"yyyy-MM-dd"),s.toString(),t.instrument||"",(null==(a=t.contracts)?void 0:a.toString())||"",(null==(n=t.totalPoints)?void 0:n.toString())||"",t.entryTime||"",t.exitTime||"",(null==(i=t.tradeTp)?void 0:i.toString())||"",(null==(o=t.tradeSl)?void 0:o.toString())||"",'"'.concat((e.notes||"").replace(/"/g,'""'),'"')],u=(null==(d=t.sessions)?void 0:d.filter(e=>"none"!==e.movementType))||[];u.length>0?u.forEach(e=>{r.push([...c,e.sessionName,e.movementType,e.direction,e.tookHighLow||"",e.targetSession])}):r.push([...c,...[,,,,,].fill("")])}})});let s="data:text/csv;charset=utf-8,Date,PNL,Instrument,Contracts,Total Points,Entry Time,Exit Time,Trade TP,Trade SL,Notes,Session Name,Movement Type,Direction,Sweep,Target\n"+r.map(e=>e.join(",")).join("\n"),a=encodeURI(s),n=document.createElement("a");n.setAttribute("href",a),n.setAttribute("download","trade_logs.csv"),document.body.appendChild(n),n.click(),document.body.removeChild(n)}catch(e){console.error("Failed to generate CSV",e),alert("An error occurred while generating the CSV file.")}},children:[(0,s.jsx)(g.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Download CSV"})]}),(0,s.jsx)(N.$,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:function(){r((0,f.j)(t,{months:1}))},children:(0,s.jsx)(p.A,{className:"h-4 w-4"})}),(0,s.jsx)(N.$,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:function(){r((0,m.W)(t,{months:1}))},children:(0,s.jsx)(h.A,{className:"h-4 w-4"})})]})]}),(0,s.jsx)("div",{className:"grid grid-cols-7 text-xs text-center font-semibold text-muted-foreground border-b border-t border-foreground -mr-px -mb-px",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,s.jsx)("div",{className:"py-2 border-r border-foreground",children:e},e))}),(0,s.jsx)("div",{className:"grid grid-cols-7 -mr-px -mb-px",children:R.map(e=>{let r=S[(0,l.GP)(e,"yyyy-MM-dd")],a=(0,u.t)(e,t),n="";r&&(r.pnl>0?n="hsl(var(--chart-1))":r.pnl<0?n="hsl(var(--destructive))":r.isLogged&&(n="hsl(var(--muted))"));let i=r?r.pnl>0?"text-green-500":r.pnl<0?"text-red-500":"":"",o=(null==r?void 0:r.isLogged)&&0===r.pnl;return(0,s.jsx)("div",{onClick:()=>a&&O(e),className:(0,v.cn)("relative flex flex-col justify-center items-center text-xs transition-colors h-20 p-1 border-b border-r border-foreground",a&&"cursor-pointer",!a&&"bg-transparent pointer-events-none",a&&!(null==r?void 0:r.isLogged)&&"hover:bg-accent/50"),style:(null==r?void 0:r.isLogged)&&a?{boxShadow:"inset 0 0 0 2px ".concat(n)}:{},children:a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("time",{dateTime:(0,l.GP)(e,"yyyy-MM-dd"),className:(0,v.cn)("absolute top-1.5 left-1.5 font-semibold text-xs h-5 w-5 flex items-center justify-center z-10",E(e)&&"rounded-full bg-white text-black",i),children:(0,l.GP)(e,"d")}),(null==r?void 0:r.isLogged)?(0,s.jsx)("div",{className:"p-1 text-center",children:o?(0,s.jsx)("span",{className:"font-bold text-sm text-muted-foreground",children:"NO TRADE"}):(0,s.jsx)("span",{className:(0,v.cn)("font-bold text-base",i),children:r.pnl.toLocaleString("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0})})}):null,(null==r?void 0:r.isLogged)?null:(0,s.jsx)("div",{className:"h-full w-full"})]}):(0,s.jsx)("div",{className:"h-full w-full bg-transparent"})},e.toString())})})]})}var S=r(6695),L=r(7655);let T=a.forwardRef((e,t)=>{let{className:r,children:a,...l}=e;return(0,s.jsxs)(L.bL,{ref:t,className:(0,v.cn)("relative overflow-hidden",r),...l,children:[(0,s.jsx)(L.LM,{className:"h-full w-full rounded-[inherit]",children:a}),(0,s.jsx)(C,{}),(0,s.jsx)(L.OK,{})]})});T.displayName=L.bL.displayName;let C=a.forwardRef((e,t)=>{let{className:r,orientation:a="vertical",...l}=e;return(0,s.jsx)(L.VM,{ref:t,orientation:a,className:(0,v.cn)("flex touch-none select-none transition-colors","vertical"===a&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===a&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",r),...l,children:(0,s.jsx)(L.lr,{className:"relative flex-1 rounded-full bg-border"})})});function D(){let[e,t]=a.useState([]);return a.useEffect(()=>{let e=localStorage.getItem("all-trades");e&&t(JSON.parse(e).flatMap((e,t)=>{var r;if(!e.trades)return[];let s=null==(r=e.trades)?void 0:r.some(e=>!!e.analysisImage);return e.trades.map((r,a)=>({id:"".concat(t,"-").concat(a),date:new Date(e.date),instrument:r.instrument,profitOrLoss:r.pnl,isNoTrade:s&&0===r.pnl}))}).filter(e=>0!==e.profitOrLoss||e.isNoTrade).sort((e,t)=>t.date.getTime()-e.date.getTime()))},[]),(0,s.jsxs)(S.Zp,{className:"h-full flex flex-col retro-border",children:[(0,s.jsx)(S.aR,{className:"border-b",children:(0,s.jsx)(S.ZB,{className:"font-headline text-lg uppercase",children:"Recent Trades"})}),(0,s.jsx)(S.Wu,{className:"pt-2 flex-1 min-h-0",children:(0,s.jsx)(T,{className:"h-full",children:e.length>0?(0,s.jsx)("ul",{className:"space-y-3 pr-4",children:e.map(e=>(0,s.jsxs)("li",{className:"flex justify-between items-center gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 shrink-0",children:[(0,s.jsxs)("div",{className:"w-10 text-center",children:[(0,s.jsx)("p",{className:"font-bold text-sm",children:(0,l.GP)(e.date,"d")}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:(0,l.GP)(e.date,"MMM")})]}),(0,s.jsx)("p",{className:"font-semibold text-sm w-16 truncate",children:e.instrument})]}),e.isNoTrade?(0,s.jsx)("p",{className:"text-sm text-muted-foreground text-right min-w-[80px]",children:"No Trade"}):(0,s.jsx)("p",{className:(0,v.cn)("font-bold text-sm text-right min-w-[80px]",e.profitOrLoss>0?"text-green-500":"text-red-500"),children:e.profitOrLoss.toLocaleString("en-US",{style:"currency",currency:"USD"})})]},e.id))}):(0,s.jsx)("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:(0,s.jsx)("p",{children:"No recent trades"})})})})]})}function M(e){let{title:t,value:r,children:a,valueClassName:l}=e;return(0,s.jsxs)(S.Zp,{className:"text-center h-28 flex flex-col justify-center retro-border",children:[t&&(0,s.jsx)(S.aR,{className:"p-4 pb-2",children:(0,s.jsx)(S.ZB,{className:"font-headline text-sm font-medium text-muted-foreground uppercase",children:t})}),(0,s.jsxs)(S.Wu,{className:"p-4 pt-0 flex-1",children:[r&&(0,s.jsx)("p",{className:(0,v.cn)("text-4xl font-bold text-foreground",l),children:r}),a]})]})}C.displayName=L.VM.displayName;var k=r(5863);let P=a.forwardRef((e,t)=>{let{className:r,value:a,indicatorClassName:l,...n}=e;return(0,s.jsx)(k.bL,{ref:t,className:(0,v.cn)("relative h-4 w-full overflow-hidden rounded-none border border-foreground bg-background",r),...n,children:(0,s.jsx)(k.C1,{className:(0,v.cn)("h-full w-full flex-1 bg-foreground transition-all",l),style:{transform:"translateX(-".concat(100-(a||0),"%)")}})})});function R(){let[e,t]=a.useState(0),[r,l]=a.useState(0);return a.useEffect(()=>{let e=localStorage.getItem("all-trades");if(e){let r=new Set(JSON.parse(e).filter(e=>{var t,r;let s=(null==(t=e.trades)?void 0:t.reduce((e,t)=>e+(t.pnl||0),0))||0,a=null==(r=e.trades)?void 0:r.some(e=>!!e.analysisImage);return 0!==s||a&&0===s}).map(e=>new Date(e.date).toDateString())).size;l(r),t(r/30*100)}},[]),(0,s.jsxs)(S.Zp,{className:"h-28 flex flex-col justify-center p-4 retro-border",children:[(0,s.jsx)(S.aR,{className:"p-0 pb-2",children:(0,s.jsxs)(S.ZB,{className:"font-headline text-sm font-medium text-muted-foreground flex justify-between uppercase",children:[(0,s.jsx)("span",{children:"LOG 30 DAYS"}),(0,s.jsxs)("span",{children:[r,"/",30]})]})}),(0,s.jsx)(S.Wu,{className:"p-0",children:(0,s.jsx)(P,{value:e,className:"h-6",indicatorClassName:"bg-green-500"})})]})}function E(){let[e,t]=a.useState({netPnl:0,avgWin:0,winRate:0}),[r,l]=a.useState(!1);a.useEffect(()=>{l(!0)},[]),a.useEffect(()=>{{let e=localStorage.getItem("all-trades");if(e)try{let r=JSON.parse(e).flatMap(e=>(e.trades||[]).map(t=>({...t,date:new Date(e.date)}))),s=r.filter(e=>0!==e.pnl),a=r.reduce((e,t)=>e+(t.pnl||0),0),l=s.filter(e=>(e.pnl||0)>0),n=l.length>0?l.reduce((e,t)=>e+(t.pnl||0),0)/l.length:0,i=s.length>0?l.length/s.length*100:0;t({netPnl:a,avgWin:n,winRate:i})}catch(e){console.error("Failed to parse trade logs",e)}}},[r]);let n=e.netPnl>0?"text-green-500":e.netPnl<0?"text-red-500":"text-foreground",i=e.avgWin>0?"text-green-500":"text-foreground";return(0,s.jsx)("div",{className:"flex flex-col min-h-screen text-foreground p-4",children:(0,s.jsx)("main",{className:"flex-1 md:px-8 md:py-6",children:(0,s.jsx)("div",{className:"mx-auto w-full max-w-7xl",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,s.jsx)("div",{className:"lg:col-span-3 space-y-6",children:(0,s.jsxs)("div",{className:"space-y-6",children:[r&&(0,s.jsx)(w,{}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,s.jsx)("div",{className:"col-span-1",children:(0,s.jsx)(M,{title:"Net P&L",value:e.netPnl.toLocaleString("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}),valueClassName:n})}),(0,s.jsx)("div",{className:"col-span-1",children:(0,s.jsx)(M,{title:"Avg Trade Win",value:e.avgWin.toLocaleString("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}),valueClassName:i})}),(0,s.jsx)("div",{className:"col-span-1",children:(0,s.jsx)(M,{title:"Win Rate",value:"".concat(e.winRate.toFixed(0),"%")})}),(0,s.jsx)("div",{className:"col-span-1",children:(0,s.jsx)(R,{})})]})]})}),(0,s.jsx)("div",{className:"lg:col-span-1",children:(0,s.jsx)(D,{})})]})})})})}P.displayName=k.bL.displayName},6695:(e,t,r)=>{"use strict";r.d(t,{Wu:()=>d,ZB:()=>o,Zp:()=>n,aR:()=>i});var s=r(5155),a=r(2115),l=r(9434);let n=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("rounded-none bg-transparent",r),...a})});n.displayName="Card";let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-4",r),...a})});i.displayName="CardHeader";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});o.displayName="CardTitle",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",r),...a})}).displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("p-4 pt-0",r),...a})});d.displayName="CardContent",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-4 pt-0",r),...a})}).displayName="CardFooter"},9434:(e,t,r)=>{"use strict";r.d(t,{cn:()=>l});var s=r(2596),a=r(9688);function l(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,s.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[846,198,874,352,441,684,358],()=>t(2751)),_N_E=e.O()}]);